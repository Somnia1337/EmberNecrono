ğŸ‘ˆ [[5 æ¨¡å¼åŒ¹é…]]

æ–¹æ³•å¾€å¾€ä¸å¯¹è±¡æˆå¯¹å‡ºç°ï¼š

```rust
object.method()
```

æ–¹æ³•ä¸å‡½æ•°çš„å¯¹æ¯”ï¼šè¯»å–ä¸€ä¸ªæ–‡ä»¶å†™å…¥ç¼“å†²åŒºâ€”â€”

- å‡½æ•°å†™æ³•ï¼š`read(file, buffer)`
- æ–¹æ³•å†™æ³•ï¼š`file.read(buffer)`

### `impl`

å…³é”®å­— `impl`ï¼šä¸ºç»“æ„ä½“å®šä¹‰æ–¹æ³•ã€‚

```rust
struct Circle {
    x: f64,
    y: f64,
    radius: f64,
}

impl Circle { // è¡¨æ˜å—çš„å†…å®¹ä¸ Circle æœ‰å…³
    fn new(x: f64, y: f64, radius: f64) -> Circle {
        Circle {
            x: x,
            y: y,
            radius: radius,
        }
    }
	
    fn area(&self) -> f64 {
        std::f64::consts::PI * (self.radius * self.radius)
    }
}
```

åœ¨ `impl Circle { }` å—å†…ï¼Œæœ‰ä¸€ä¸ªå‡½æ•°å’Œä¸€ä¸ªæ–¹æ³•ï¼š

- `new()`ï¼šå…³è”å‡½æ•°ï¼ˆæ ‡å¿—ï¼šç¬¬ä¸€ä¸ªå‚æ•°ä¸æ˜¯ `self`ï¼‰ï¼Œç”¨äºåˆå§‹åŒ–å½“å‰ç»“æ„ä½“çš„å®ä¾‹ã€‚`new` ä¸æ˜¯ Rust çš„å…³é”®å­—ï¼Œè€Œæ˜¯çº¦å®šä¿—æˆçš„æ„é€ å™¨åç§°ã€‚
- `area()`ï¼šæ–¹æ³•ï¼ˆæ ‡å¿—ï¼šç¬¬ä¸€ä¸ªå‚æ•°ä¸º `self`ï¼‰ï¼Œå‚æ•° `&self` è¡¨ç¤ºå€Ÿç”¨å½“å‰çš„ `Circle` å®ä¾‹ã€‚

Rust å’Œå…¶ä»–è¯­è¨€ä¸­â€œç±»â€çš„å¯¹æ¯”ï¼š

![[ä¸å…¶ä»–è¯­è¨€çš„æ–¹æ³•å¯¹æ¯”.png|250]]

Rust çš„å¯¹è±¡å®šä¹‰ï¼ˆæ•°æ®ï¼‰ä¸æ–¹æ³•å®šä¹‰ï¼ˆä½¿ç”¨ï¼‰æ˜¯åˆ†ç¦»çš„ï¼Œçµæ´»åº¦å¾ˆé«˜ã€‚

å¦ä¸€ä¸ªç¤ºä¾‹ï¼š

```rust
struct Rectangle {
    width: u32,
    height: u32,
}

impl Rectangle {
    fn area(&self) -> u32 {
        self.width * self.height
    }
}

fn main() {
    let rect1 = Rectangle {
        width: 30,
        height: 50,
    };
    println!(
        "The area of the rectangle is {} square pixels.",
        rect1.area()
    );
}
```

### `self`ï¼Œ`&self`ï¼Œ`&mut self`

å†çœ‹ `area`ï¼š

```rust
impl Rectangle {
    fn area(&self) -> u32 {
        self.width * self.height
    }
}
```

ç­¾åä¸­çš„ `&self` å…¶å®æ˜¯ `self: &Self` çš„ç®€å†™ï¼Œè¿™é‡Œç”¨ `&self` æŒ‡ä»£ `rectangle: &Rectangle`ã€‚

åœ¨ `impl` å—å†…ï¼Œ`Self` æŒ‡ä»£è¢«å®ç°æ–¹æ³•çš„ç»“æ„ä½“ç±»å‹ï¼Œ`self` æŒ‡ä»£ç»“æ„ä½“å®ä¾‹ã€‚

`self` ä¾ç„¶æœ‰æ‰€æœ‰æƒçš„æ¦‚å¿µï¼š

- `self` è¡¨ç¤ºæ‰€æœ‰æƒè½¬ç§»åˆ°æ–¹æ³•å†…ï¼Œä½¿ç”¨è¾ƒå°‘ï¼Œå¾€å¾€ç”¨äºæŠŠå½“å‰çš„å¯¹è±¡è½¬æˆå¦å¤–ä¸€ä¸ªå¯¹è±¡æ—¶ä½¿ç”¨ã€‚
- `&self` è¡¨ç¤ºæ–¹æ³•å¯¹ç»“æ„ä½“å®ä¾‹çš„ä¸å¯å˜å€Ÿç”¨ï¼Œåªèƒ½è¯»å–å®ä¾‹çš„æ•°æ®ã€‚
- `&mut self` è¡¨ç¤ºå¯å˜å€Ÿç”¨ï¼Œå¯ä»¥ä¿®æ”¹ç»“æ„çš„æ•°æ®ã€‚

### æ–¹æ³•ä¸å­—æ®µåŒå

Rust å…è®¸æ–¹æ³•ä¸ç»“æ„ä½“çš„å­—æ®µåŒåï¼š

```rust
struct Rectangle {
    width: u32,
    height: u32,
}

impl Rectangle {
    fn width(&self) -> bool { // ä¸å­—æ®µ width åŒå
        self.width > 0
    }
}

fn main() {
    let rect = Rectangle {
        width: 30,
        height: 50,
    };
	
    if rect.width() { // è°ƒç”¨æ–¹æ³• width()
        println!("The rectangle has a nonzero width, it is {}", rect.width); // è°ƒç”¨å­—æ®µ width
    }
}
```

æ–¹æ³•ä¸å­—æ®µåŒåå¾€å¾€ç”¨äºå®ç° `getter`ï¼Œå°†å¯¹åº”æ–¹æ³•è®¾ä¸º `pub`ï¼Œä»è€Œè®¿é—®ç§æœ‰å­—æ®µã€‚

> é»˜è®¤æ‰€æœ‰å­—æ®µéƒ½æ˜¯ç§æœ‰çš„ï¼Œåªå¯¹å½“å‰æ–‡ä»¶å¯è§ã€‚

> åœ¨ C / C++ ä¸­ï¼Œæœ‰ä¸¤ç§è¿ç®—ç¬¦ç”¨äºæ–¹æ³•è°ƒç”¨ï¼š`.` ç›´æ¥åœ¨å¯¹è±¡ä¸Šè°ƒç”¨æ–¹æ³•ï¼›`->` åœ¨å¯¹è±¡çš„æŒ‡é’ˆä¸Šè°ƒç”¨æ–¹æ³•ï¼Œéœ€è¦å…ˆè§£å¼•ç”¨ã€‚å¦‚æœ `p` æ˜¯ä¸€ä¸ªæŒ‡é’ˆï¼Œ`p->method()` ç­‰ä»·äº `(*p).method()`ã€‚
> 
> Rust æ²¡æœ‰ `->` è¿ç®—ç¬¦ï¼Œè€Œæœ‰è‡ªåŠ¨å¼•ç”¨å’Œè§£å¼•ç”¨çš„åŠŸèƒ½ï¼Œæ–¹æ³•è°ƒç”¨æ˜¯ Rust å°‘æ•°å‡ ä¸ªè¡¨ç°å‡ºè¿™ç§åŠŸèƒ½çš„åœ°æ–¹ã€‚å½“ä½¿ç”¨ `p.method()` æ—¶ï¼ŒRust è‡ªåŠ¨ä¸º `p` æ·»åŠ  `&` / `&mut` / `*`ï¼Œä½¿ `p` ä¸æ–¹æ³•ç­¾ååŒ¹é…ã€‚

### å¤šä¸ªå‚æ•°

```rust
struct Rectangle {
    width: u32,
    height: u32,
}

impl Rectangle {
    fn area(&self) -> u32 {
        self.width * self.height
    }
	
    fn can_hold(&self, other: &Rectangle) -> bool {
        self.width > other.width && self.height > other.height
    }
}
```

### å…³è”å‡½æ•°

å®šä¹‰åœ¨ `impl` å—ä¸­ä¸”æ²¡æœ‰ `self` å‚æ•°çš„å‡½æ•°ç§°ä¸ºå…³è”å‡½æ•°ï¼Œå› ä¸ºå®ƒä¸èƒ½ä»¥ `p.method()` çš„å½¢å¼è°ƒç”¨ï¼Œå› æ­¤ç§°ä¸ºå‡½æ•°ã€‚

> å¦ä¸€ç§è§‚ç‚¹ï¼šæ–¹æ³• method æ˜¯å…³è”å‡½æ•° associated functions çš„å­é›†ï¼Œåªè¦åœ¨ `impl` å—ä¸­çš„éƒ½ä¸ºå…³è”å‡½æ•°ï¼Œå…¶ä¸­æœ‰ `self` å‚æ•°çš„ä¸ºæ–¹æ³•ã€‚

å‡½æ•°éœ€è¦ä»¥ `::` è°ƒç”¨ï¼š

```rust
struct Rectangle {
    width: u32,
    height: u32,
}

impl Rectangle {
    fn new(w: u32, h: u32) -> Rectangle {
        Rectangle {
            width: w,
            height: h,
        }
    }
}

fn main() {
    let sq = Rectangle::new(3, 3);
}
```

å¸¸ç”¨çš„ `String::from` å°±æ˜¯ `String` çš„å…³è”å‡½æ•°ã€‚

### å¤šä¸ª `impl`

å¯ä»¥ä¸ºä¸€ä¸ªç»“æ„ä½“å®šä¹‰å¤šä¸ª `impl` å—ï¼Œå®ƒä»¬ä»å°†å…±åŒå®ç°è¯¥ç»“æ„ä½“çš„æ–¹æ³•ã€‚å¥½å¤„æ˜¯æé«˜ä»£ç çš„å¯è¯»æ€§ã€çµæ´»æ€§ã€‚

```rust
impl Rectangle {
    fn area(&self) -> u32 {
        self.width * self.height
    }
}

impl Rectangle {
    fn can_hold(&self, other: &Rectangle) -> bool {
        self.width > other.width && self.height > other.height
    }
}
```

### ä¸º `enum` å®ç°æ–¹æ³•

å¯ä»¥åƒä¸ºç»“æ„ä½“å®ç°æ–¹æ³•ä¸€æ ·ï¼Œä¸ºæšä¸¾å®ç°æ–¹æ³•ï¼š

```rust
enum Message {
    Quit,
    Move { x: i32, y: i32 },
    Write(String),
}

impl Message {
    fn call(&self) {
        // ...
    }
}
```

ğŸ‘‰ [[7 æ³›å‹å’Œç‰¹å¾]]