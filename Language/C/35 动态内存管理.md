### 变长数组

直接在数组声明的方括号内填写变量来声明一个变长数组，不过这种方法已经从C中移除。

现存方法：使用头文件stdlib.h中声明的malloc函数从内存中申请一段连续的空间。

malloc原型：

![[35-1.png|450]]

在C中，void\*可以通过赋值转换为其它类型的指针（C++中必须先强制转换才能赋值）。

malloc使用示例：

![[35-2.png|450]]

此例展示了申请4字节、8字节的空间。

![[35-3.png|450]]

此例展示了申请40字节的空间用于数组。

由于malloc函数申请空间可能会失败，因此应该先判断返回值是否为空再赋值。

### 释放内存空间

用函数free释放此前申请的内存空间。

free原型与原理：

![[35-4.png|450]]

free使用示例：

![[35-5.png|450]]

如果没有用free释放内存空间，内存空间会一直保留至程序结束。

因此，对于不再使用的内存空间，应该及时释放。

内存泄漏：内存空间被占用且无法被释放。

循环使用malloc可能导致内存泄漏。

![[35-6.png|450]]

![[35-7.png|450]]