### 联合

**关键词union**：声明联合，格式与struct类似：

![[26-1.png|450]]

用关键词sizeof查看struct与union分别占用的空间，按道理char 1 + short 2 + long long 8 = 11，然而二者的大小分别为16、8。

![[26-2.png|450]]

**内存对齐**：相邻成员的首地址相差一些多余的空间，会浪费一些空间，但是对齐的数据能被更快地访问。struct是内存对齐数据结构。

![[26-3.png|450]]

union不是内存对齐数据结构。

![[26-4.png|450]]

union的sizeof大小是==其内最大成员的大小==，各个成员分配的空间有重叠，所以==后来的成员会覆盖掉原先的成员==，联合也叫共用。

### 联合的应用

有一种信息，它可能以整型、浮点型、字符串3种形式出现且每次只是其中一种，现在要写一个结构体来存储这种信息。

![[26-5.png|450]]

缺陷：每次只用到一个成员，其他两个被浪费。

可以把内部成员改写到union内：

![[26-6.png|250]]

还可以用**匿名嵌套**：去除union后括号后的"u"，在调用时，把union的成员当作message的成员处理。

![[26-7.png|300]]

### 枚举

在上例中，用3个数字代表3种数据类型。

但是当数据量增加，很难记住数字与类型的对应关系。

**枚举类型enum**：一种特殊的整型，可以**用任意的字符串代替整数**，比如将上例中的1、2、3用三个单词代替：

![[26-8.png|250]]

enum的声明格式也类似于struct，也可以使用别名：

![[26-9.png|250]]

==默认从0递增==：分别打印这3个枚举类型，值分别为0、1、2.

如果想让它们从1开始递增，只需改写为：

![[26-10.png|250]]

甚至==可以指定每一个成员的数值==：

![[26-11.png|250]]

### 枚举的应用

将上例中结构成员type改为enum类型：

![[26-12.png|300]]

printMsg函数中，case后跟枚举值：

![[26-13.png|300]]

主函数中，对每条消息用枚举赋值标明类型：

![[26-14.png|300]]