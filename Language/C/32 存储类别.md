### 自动变量

![[32-1.png|450]]

在标识符的作用域外，尝试通过其指针访问其值。

![[32-2.png|450]]

编译时警告：返回局部变量或临时变量的地址n。

默认情况下，==声明在代码块内的==任何变量都属于==自动存储类别==。

**局部变量**：自动变量的别称，拥有==块内作用域与生命期==的变量。

**生命期**：自动变量创建到销毁的存在周期。

![[32-3.png]]

**关键词auto**：添加在变量声明语句的开头，表明这个变量属于自动存储类别（默认情况下就已经是自动存储类别，不需要加）。

生命期与作用域：

![[32-4.png|450]]

![[32-5.png|450]]

在此例中：

![[32-6.png|450]]

**野指针**：指向一个==已失效空间==的指针。如图中`pN`。

### 静态变量

#### 具有文件作用域的静态变量

**全局变量**：静态存储类别变量的别称，==声明在代码块外==的变量。

静态存储类别变量的生命期：程序启动到程序结束。

自动初始化：如果静态存储类别变量没有被初始化，则==自动初始化为0==。

#### 具有块作用域的静态变量

将静态存储类别变量的声明放入某个块内，它就变为自动存储类别变量。

在声明语句开头添加关键词static（见[[20 多级指针与指针数组]]）就声明了一个具有块作用域的静态变量。区别在于，==它的作用域为声明所在块，在该块外无法使用==：

![[32-7.png|300]]

==要在该块外调用标识符，可以使用其指针==，而且由于其生命期等于程序生命期，不会出现野指针的问题。

#### 外部链接的静态变量

在代码块外定义的标识符具有文件作用域，那么在两个源文件中定义同名变量：

![[32-8.png|450]]

运行程序，可以通过编译，但是无法通过链接：

![[32-9.png|450]]

这是因为==多个源文件中不允许出现同名全局变量==，但是==可以共享同一个全局变量==。

**关键词extern**：要在多个文件中使用同名全局变量，==只需在其中一个文件中声明该变量，然后在其它文件中同名变量的声明语句开头添加extern，表示链接到外部文件的同名变量==。

#### 仅限本文件使用的全局变量

如果不希望某个文件中的某个全局变量被其它文件链接使用，==在其声明语句开头添加关键词static==。

附加作用：==即使其它文件中出现了同名变量的声明，也不会出现标识符重定义错误==，规避了可能的问题。