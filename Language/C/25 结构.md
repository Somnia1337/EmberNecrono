### 人员信息管理系统

需求：存储若干人的姓名、性别、身高、体重信息。

数组实现：

![[25-1.png|450]]

局限性：代码冗长；只能一次性输入所有信息，不能追加。

需求：一个菜单式程序主界面，根据用户输入执行不同操作。

![[25-2.png|450]]

实现：

![[25-3.png|450]]

上图中的==system是头文件stdlib.h中声明的函数==，其参数为一串字符串，这个字符串是==命令行中的一串命令==，图中的"cls"用于清除控制台中之前显示过的内容，"pause"用于暂停程序执行、按任意键后继续执行。

### 聚合数据

在上述实例中，每个人的各项信息被拆散在不相关的数组里。

我们希望能把每个人的各项信息存储在一个实体里，多个这样的实体组成一个集合体，这就需要引入新的数据类型struct。

**结构struct**：可以容纳多个不同类型数据的大数组（或单个变量）。

```c
struct {
    char name[20];
    int gender;
    double height;
    double weight;
}infoOfPerson[10];
```

也可以只有一个结构体，去除上文代码中的“\[10\]”即可。

访问：*结构体名称*\[*下标*\].*字段名*（注意点号(.)）。

```c
infoOfPerson[0].name
```

输入输出：与数组类似。

```c
scanf("%s %d %lf %lf", infoOfPerson[0].name, &infoOfPerson[0].gender, &infoOfPerson[0].height, &infoOfPerson[0].weight);
```

### 结构别名

![[25-4.png|300]]

如图，3个结构体的内部成员相同，若想只声明一次、还想保留各自的名称（timmy、david、jane）（即：不写成数组\[3\]），可以使用**别名**。

![[25-5.png|300]]

在第一次声明时，struct与花括号之间添加一个别名（图为person），之后只需用“struct 别名 结构名”就可以声明新的同类结构体。

更推荐的做法是：第一次声明时仅使用别名，相当于声明了一个结构体模板，此后声明结构体时套用这个模板，如图：

![[25-6.png|300]]

注意：如果结构体模板在函数内部声明，那么该模板的使用也仅限于该函数内部。

结构体的初始化示例如图：

![[25-7.png|450]]

**结构数组**：

![[25-8.png|450]]

### 嵌套结构

![25-9.png](25-9.png)

例如：A、B为模板，a、b为对应的结构变量，要在B中嵌套A。

嵌套方式：在B的声明里包含`struct A a;`。

初始化：在B的初始化列表中对应位置用花括号包括A的初始化列表。

访问方式：使用**多重点号**`b.a.xxx`。

### 结构指针

```c
struct person {
    char name[20];
    int gender;
    double height;
    double weight;
};
struct person tim = { "tim",1,175.0,62.5 };
struct person* pTim = &tim; //声明指针，需要添加别名
printf("%s", (*pTim).name);
```

在行9里，由于==点号.的优先级高于星号*==，所以需要添加括号先将指针还原再读取结构体内数据。

或者使用==成员间接运算符(->)==

```c
(*pTim).name
//等价于
pTim->name
```

此运算符==前面只能是指针==，不能是结构体变量名。

### 用函数修改结构

指针间接修改：

![[25-10.png|450]]

直接修改结构：

![[25-11.png|450]]