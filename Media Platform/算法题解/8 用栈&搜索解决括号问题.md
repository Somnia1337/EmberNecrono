## 856. æ‹¬å·çš„åˆ†æ•°

#### å‰è¨€

ã€ŒåŠ›æ‰£é¢˜è§£ã€ç³»åˆ—è‡´åŠ›äºåˆ†äº«æœ‰ä»·å€¼çš„é¢˜ç›®ã€æ¢è®¨æ›´ä¼˜ç§€çš„è§£æ³•ã€‚

è¿™æ˜¯æœ¬ç³»åˆ—çš„ç¬¬ 8 ç¯‡é¢˜è§£ï¼Œæ›´å¤šé¢˜è§£å…³æ³¨ Somnia1337@åŠ›æ‰£ã€‚

#### é¢˜ç›®æè¿°

> éš¾åº¦ï¼šğŸŸ¡ä¸­ç­‰
>
> æ ‡ç­¾ï¼š\#æ ˆ \#å­—ç¬¦ä¸²

ç»™å®šä¸€ä¸ªå¹³è¡¡æ‹¬å·å­—ç¬¦ä¸²Â `s`ï¼ŒæŒ‰ä¸‹è¿°è§„åˆ™è®¡ç®—è¯¥å­—ç¬¦ä¸²çš„åˆ†æ•°ï¼š

- `()`Â å¾— 1 åˆ†ã€‚
- `AB`Â å¾—Â `A + B`Â åˆ†ï¼Œå…¶ä¸­ A å’Œ B æ˜¯å¹³è¡¡æ‹¬å·å­—ç¬¦ä¸²ã€‚
- `(A)`Â å¾—Â `2 * A`Â åˆ†ï¼Œå…¶ä¸­ A æ˜¯å¹³è¡¡æ‹¬å·å­—ç¬¦ä¸²ã€‚

```text
è¾“å…¥ï¼š"(()(()))"
è¾“å‡ºï¼š6
è§£é‡Šï¼šå†…å±‚çš„ "()" 1 åˆ†ã€"(())" 1*2=2 åˆ†ï¼Œæœ€ç»ˆ (1+2)*2=6 åˆ†
```

#### è§£é¢˜æ€è·¯

##### å¤–æŒ‚ï¼šPython è°ƒåº“

è°ƒåº“ä½œå¦‚ä¸‹æ›¿æ¢ï¼š

- ")(" æ¢ä¸º ")+("
- "()" æ¢ä¸º "1"
- "(" æ¢ä¸º "2*("

è¿™æ ·ï¼Œ"(()(()))" å˜ä¸º "2*(1+2*(1))"ï¼Œå†è°ƒç”¨ `eval()` è®¡ç®—ä¸­ç¼€è¡¨è¾¾å¼çš„å€¼ã€‚

```python
class Solution:
    def scoreOfParentheses(self, s: str) -> int:
        return eval(s.replace(")(", ")+(").replace("()", "1").replace("(", "2*("))
```

â€œç­”å¾—ä¸é”™ï¼Œä»Šå¤©çš„é¢è¯•å°±åˆ°è¿™é‡Œå§ï¼â€

##### æ–¹æ³• 1ï¼šDFS

> æ€è·¯ä¸å›¾ç‰‡æ¥æº HongKy@åŠ›æ‰£ã€‚

![[@2023.11.24-1.png|400]]

æ‹¬å·ä¹‹é—´æœ‰ç€æ˜æ˜¾çš„å±‚çº§å…³ç³»ï¼Œå¯ä»¥å°†ä¹‹è§†ä¸ºæ ‘çŠ¶ç»“æ„ï¼š

![[@2023.11.24-2.png|300]]

![[@2023.11.24-3.png|300]]

- å½“ä¸€ä¸ªç»“ç‚¹æ²¡æœ‰å­ç»“ç‚¹çš„æ—¶å€™ï¼Œé‚£ä¹ˆè¿™ä¸ªç»“ç‚¹çš„å€¼ä¸º 1
- å¦åˆ™ï¼Œä¸ºæ‰€æœ‰å­ç»“ç‚¹ä¹‹å’Œ * 2

ç”¨ `c == ')'` åˆ¤æ–­ç»“ç‚¹çš„å¼€å§‹ï¼ŒåŒæ ·åˆ¤æ–­æ˜¯å¦æœ‰å­ç»“ç‚¹ã€‚

```java
class Solution {
    private int it = 0;
	
    public int scoreOfParentheses(String s) {
        int ans = 0;
        while (it < s.length() && s.charAt(it) == '(') {
            it++;
            if (s.charAt(it) == ')') ans++; // æ²¡æœ‰å­ç»“ç‚¹
            else ans += scoreOfParentheses(s) * 2; // æœ‰å­ç»“ç‚¹
            it++;
        }
        return ans;
    }
}
```

##### æ–¹æ³• 2ï¼šæ ˆ

å®šä¹‰ç©ºä¸²çš„åˆ†æ•°ä¸º 0ï¼Œéå†ï¼š

- é‡åˆ° '(' æ—¶ï¼Œå‹å…¥ 0ï¼Œä½œä¸ºæš‚æ—¶çš„åˆ†æ•°ã€‚
- é‡åˆ° ')' æ—¶ï¼Œå¼¹å‡ºçš„åˆ†æ•°ä¸ºå½“å‰æ‹¬å·å¯¹ä¹‹é—´çš„åˆ†æ•°ï¼Œå°†å…¶ä¹˜ 2ï¼Œä¸ 1 å–è¾ƒå¤§è€…ï¼ŒåŠ ä¸Šå†æ¬¡å¼¹å‡ºçš„åˆ†æ•°

ä»¥ "(()(()))" ä¸ºä¾‹ï¼Œå±•ç¤ºè¿™ä¸ªè¿‡ç¨‹ï¼š

```text
i  c  stk
-1    [0
0  (  [0,0
1  (  [0,0,0
2  )  [0,1
3  (  [0,1,0
4  (  [0,1,0,0
5  )  [0,1,1
6  )  [0,3
7  )  [6
```

```java
class Solution {
    public int scoreOfParentheses(String s) {
        Deque<Integer> stk = new ArrayDeque<>();
        stk.push(0); // åˆå§‹æ—¶å‹å…¥ 0
        for (int i = 0; i < s.length(); i++) {
            if (s.charAt(i) == '(') stk.push(0); // å‹æ ˆ
            else stk.push(Math.max(2 * stk.pop(), 1) + stk.pop()); // æ›´æ–°æ ˆé¡¶
        }
        return stk.peek(); // æ ˆé¡¶å…ƒç´ å³ä¸ºç­”æ¡ˆ
    }
}
```

##### æ–¹æ³• 3ï¼šåŠ æƒå’Œ

ä»æ ¹æºä¸Šï¼Œåˆ†æ•°å…¨éƒ¨æ¥æºäºåŸå­æ‹¬å·å¯¹ "()"ï¼Œå¯¹æ·±åº¦ä¸º `d` çš„åŸå­ï¼Œå®ƒå¯¹æœ€ç»ˆåˆ†æ•°çš„è´¡çŒ®ä¸º $2^d$ã€‚éå†æ—¶ï¼Œé‡åˆ° '(' å°† `d` åŠ  1ã€é‡åˆ° ')' å°† `d` å‡ 1ï¼Œå¹¶åœ¨åŒ¹é…åˆ°åŸå­æ—¶å°† `1 << d` ç´¯åŠ åˆ°ç­”æ¡ˆã€‚

```java
class Solution {
    public int scoreOfParentheses(String s) {
        int n = s.length(), d = 0, ans = 0;
        for (int i = 0; i < n; i++) {
            d += (s.charAt(i) == '(' ? 1 : -1); // æ›´æ–°æ·±åº¦
            if (s.charAt(i) == ')' && s.charAt(i - 1) == '(') ans += 1 << d; // åŒ¹é…åˆ°åŸå­, ç´¯åŠ ç­”æ¡ˆ
        }
        return ans;
    }
}
```

#### æœ€å

æ›´å¤šç³»åˆ—ã€Œå¤–æºæ¨æ–‡ã€&ã€Œç”Ÿæ´»åˆ†äº«ã€å…³æ³¨å…¬ä¼—å·ï¼š