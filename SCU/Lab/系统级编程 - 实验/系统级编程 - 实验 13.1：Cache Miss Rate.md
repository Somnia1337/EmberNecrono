@2024.05.30 | Week 13

卢剑歌 2022141461145

### Q1.

3M decides to make Post-Its by printing yellow squares on white pieces of paper. As part of the printing process, they need to set the CMYK (cyan, magenta, yellow, black) value for every point in the square. 3M hires you to determine the efficiency of the following algorithms on a machine with a 2048-byte direct-mapped data cache with 32-byte blocks. You are given the following definitions:

```c
struct point_color {
	int c;
	int m;
	int y;
	int k;
};

struct point_color square[16][16];
int i, j;
```

Assume the following:

- `sizeof(int) == 4`
- Square begins at memory address `0`
- The cache is initially empty
- The only memory accesses are to the entries of the array square, variables `i` and `j` are stored in registers.

Determine the cache performance of the following code:

```c
for(i = 0; i < 16; i++) {
	for(j = 0; j < 16; j++) {
		square[i][j].c = 0;
		square[i][j].m = 0;
		square[i][j].y = 1;
		square[i][j].k = 0;
	}
}
```

> [!question] A. What is the total number of writes?

$1024$

> [!question] B. What is the total number of writes that miss in the cache?

$128$

> [!question] C. What is the miss rate?

$\large \frac{1}{8}$

### Q2.

Given the assumptions in Q1, determine the cache performance of the following code:

```c
for(i = 0; i < 16; i++) {
	for(j = 0; j < 16; j++) {
		square[j][i].c = 0;
		square[j][i].m = 0;
		square[j][i].y = 1;
		square[j][i].k = 0;
	}
}
```

> [!question] A. What is the total number of writes?

$1024$

> [!question] B. What is the total number of writes that miss in the cache?

$256$

> [!question] C. What is the miss rate?

$\large \frac{1}{4}$

### Q3.

Given the assumptions in Q1, determine the cache performance of the following code:

```c
for(i = 0; i < 16; i++) {
	for(j = 0; j < 16; j++) {
		square[i][j].y = 1;
	}
}

for(i = 0; i < 16; i++) {
	for(j = 0; j < 16; j++) {
		square[i][j].c = 0;
		square[i][j].m = 0;
		square[i][j].k = 0;
	}
}
```

> [!question] A. What is the total number of writes?

$1024$

> [!question] B. What is the total number of writes that miss in the cache?

$256$

> [!question] C. What is the miss rate?

$\large \frac{1}{4}$