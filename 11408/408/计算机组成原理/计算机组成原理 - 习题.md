## 01 计算机系统概述

### 计算机系统层次结构

冯 · 诺依曼机的基本工作方式：**控制流驱动方式**。

CPU 存取速度：**寄存器 > cache > 内存**。

相联存储器 **既可按地址寻址，又可按内容寻址**。

### 计算机的性能指标

CPI 与系统结构、指令集、计算机组织有关，而与 **时钟频率** 无关。

评价计算机系统性能的综合参数：**吞吐率**。

设计高性能计算机的重要技术途径：**采用并行处理技术**。

执行一个任务原本需要 90s 的 CPU 时间，现 CPU 速度提高 50%，则执行该任务需要 **60s**（90s -> 45s 为 100% 的提速）。

## 02 数据的表示和运算

> [!error] 教材

## 03 存储系统

### 存储器概述

磁盘属于 **直接存取存储器(DAM)**。

下列存储器中不采用随机存取方式的是 **CD-ROM**（光盘，不属于 ROM）。

### 主存储器

不正确的是 **随机存储器和只读存储器不可以统一编址**（主存由 RAM 和引导程序所在的 ROM 构成且统一编址）。

U 盘属于 **只读存储器**。

EPROM **不能作为随机存储器**（太低效）。

每推出新一代 DRAM 芯片，地址线至少增加 $1$ 根，容量至少提高到 **$4$ 倍**（DRAM 传送行列地址时复用地址线）。

某容量为 $256 "MB"$ 的存储器由若干 $4 "MB" times 8$ 位的 DRAM 芯片构成，该芯片的地址引脚和数据引脚总数为 **$19$**（地址需要 $22$ 位，由于复用，只需 $22/2 = 11$ 根引脚，$11 + 8 = 19$）。

### 主存储器与 CPU 的连接

> [!error] 教材 P105

### 外部存储器

> [!error] 教材 P113

### 高速缓冲存储器

> [!error] 教材 P125

### 虚拟存储器

访存时：

- 页表不命中 => cache 也不命中（说明该页不在主存）
- 损失：cache 不命中 $<$ 页表不命中（后者要读外存）

只有 **OS 和硬件** 可以访问页表。

`x += 3` 涉及一次读和一次写，至少访存 **$1$ 次**（写）。

> [!error] 教材 P144

## 04 指令系统

### 指令系统

CPU 执行指令的过程中，指令的地址由 **程序计数器(PC)** 给出。（指令的地址码字段为操作数地址）

> [!error] 教材 P160

### 指令的寻址方式

- 程序计数器 `PC` 存储下一条指令的地址。
- 指令寄存器 `IR` 存储当前指令本身。

相对寻址方式中，相对地址实质上是 **以下一条指令在内存中的首地址为基准位置的偏移量**（取本条指令时，PC 已经更新，指向下一条指令，随后再其基础上加偏移量）。

浮动：程序在内存的不同区域运行的能力。

对按字寻址的机器，PC 和 IR 的位数各取决于 **存储器的容量和指令字长，指令字长**。

### 程序的机器级代码表示

> [!error] 教材 P194

### CISC 和 RISC 的基本概念

## 05 中央处理器

### CPU 的功能和基本结构

下列叙述错误的是 **指令顺序执行时，PC 值总是自动加 1**。

通用寄存器的位数取决于 **机器字长**。

一台计算机的主存容量为 $4 "GB"$，存储字长和指令字长都是 $32$ 位，指令按字边界对齐存放，则 PC 的宽度至少为 **30 位**（$(4 "GB")/(32 "bit") = 2^(30)$）。

### 指令执行过程

### 数据通路的功能和基本结构

单周期 CPU **不能采用单总线结构数据通路**。

### 控制器的功能和工作原理

在微程序控制器中，形成微程序入口地址的是 **机器指令的操作码字段**。

直接编码方式 **位数最多，效率最高**。

属于控制部件的有 **指令寄存器，操作控制器，程序计数器**，~~状态条件寄存器~~。

> [!error] 教材 P241

汇编语言程序员可见的有 **基址寄存器，标志/状态寄存器**，~~指令寄存器，微指令寄存器~~。

### 异常和中断机制

访问主存时的校验错误属于 **终止**（很严重）。

进程上下文切换通过执行内核程序实现，**异常/中断的响应通过硬件实现、处理通过执行内核程序实现**。

正确的是 **外部中断的断点总是下条指令的地址**（因为执行完当前指令才响应外部中断）。

访存时缺页 **不属于中断**（中断总是来自 CPU 外部的请求）。

### 指令流水线

### 多处理器的基本概念

## 06 总线

### 总线概述

总线结构便于增减外设，并 **减少信息传输线的条数**。

不同信号在同一条信号线上分时传输的方式称为 **总线复用方式**。

总线中的信息流向：

- 数据：内存/外设 <-> CPU
- 地址：CPU -> 内存/外设
- 控制：CPU -> 内存/外设
- 状态：内存/外设 -> CPU

### 总线事务和定时

在异步总线中，传送操作 **按需分配时间**。

**并送总线传输未必比串行总线传输速度快**（高频时并行线间干扰）。

## 07 输入/输出系统

### I/O 接口

磁盘驱动器向盘片磁道写入数据采用 **串行** 方式。

主机和外设之间的连接通路为 **CPU 和主存 -> I/O 总线 -> I/O 接口 -> 通信总线（电缆）-> 外设**。

### I/O 方式

中断服务程序的最后一条指令是 **中断返回指令**（而非无条件转移指令）。

有中断请求 **不代表 CPU 执行完当前指令就响应该中断**（关中断 / 被屏蔽）。

响应中断前保护的关键硬件为 **PC 和 PSW**。

**键鼠不适用 DMA**（要求立即响应；DMA 适合大量数据）。

DMA 下，数据从内存到外设的路径为 **内存 -> 数据总线 -> DMAC -> 外设**。

一次 DMA 传送一个 **数据块**。

中断方式 **不适用于高速外设**，DMA **适用于任何速度的外设**。

中断方式下，外设准备数据的时间应 **大于中断处理时间**（否则还未及时取走数据，buffer 就被覆写）。
