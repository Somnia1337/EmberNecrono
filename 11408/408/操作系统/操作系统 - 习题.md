## 01 计算机系统概述

### 操作系统的运行环境

从内核态切换用户态是由操作系统程序执行后完成的，而从用户态切换内核态则是由 **硬件** 完成的。

下列中断事件中，能引起外部中断的事件是 **时钟中断**。

系统调用时要保存 `PSW` 和 `PC` 内容，而一般过程调用只保存 `PC`。

能在用户态执行的是 **命令解释程序**。

处理外部中断时，由 OS 保存的是 **通用寄存器的内容**（`PC` 由中断隐指令，TLB 和 cache 由硬件）。

定时器产生时钟中断后，更新所有有关“时间”的内容。

保存被中断程序的中断点由 **硬件** 完成（`not` OS）。

通过系统调用完成的操作是 **创建进程**（进程调度完全由 OS 自主完成）。

### 操作系统引导

计算机操作系统的引导程序位于 **硬盘**（设备的引导程序才位于 ROM）。

## 02 进程与线程

### 进程与线程

单处理机系统中，如果有 10 个进程，则某一时刻处于就绪队列中的进程最多为 **9** 个（不可能 10 个都就绪而不运行）。

进程通信方式中速度最快的是 **共享内存**。

正确的是 **同一进程或不同进程内的线程都可以并发执行**（注意不是“并行”）。

不属于线程优点的是 **增强进程安全性**（“一阻全阻”）。

一个进程被唤醒意味着 **它可以重新竞争 CPU**（`not` 变为运行态）。

正确的是 **无论系统是否支持线程，进程都是资源分配的基本单位**。

可能阻塞当前进程的事件有 **申请临界资源 / 读取磁盘**（“将 CPU 分配给高优先级的进程”会导致当前进程 *就绪* `not` *阻塞*）。

可能唤醒一个进程的事件有 **I/O 结束 / 另一个进程退出临界区**（“当前进程超时”可能导致一个进程 *运行* `not` *唤醒(阻塞 -> 就绪)*）

### CPU 调度

> [!warning] 本节计算类习题见书 P78 ~ P80

时间片轮转调度算法是为了 **多个用户能及时干预系统**。

临界区中的进程在退出临界区前 **可能被调度**（中断 / 抢占）。

**FCFS 调度算法** 有利于 CPU 繁忙型作业，不利于 I/O 繁忙型作业（每次请求 I/O 都要阻塞，I/O 完成后重新排队）。

**时间片轮转调度算法** 是必须可抢占的。

降低进程优先级的合理时机为 **进程超时**。

### 同步与互斥

一个临界区中的进程因申请 I/O 而被中断时，**允许其它进程抢占处理器，但不能进入该临界区**（即使被阻塞，临界区仍为它独占）。

某进程执行 `V(mutex)` 导致唤醒另一个进程，则此时 `mutex` **小于或等于 0**（唤醒 => 原本有进程在等待 => 原 `mutex <= -1` => `mutex += 1` 后 `<= 0`）。

互斥信号量 `mutex` 的初值 **总设置为 1**。

哲学家就餐问题中，左右撇子解法破坏的是 **循环等待**。

### 死锁

> [!error] 本节习题见书 P158 ~ P159

## 03 内存管理

### 内存管理概念

需要硬件地址变换机构的存储管理方式为 **各动态重定位方式**。

各存储管理方式产生的碎片：

- 固定分区 => 内
- 分页 => 内
- 分段 => 外
- 段页式 => 内

分页管理方式中，查找页表的工作由 **硬件** 完成。

**分段管理方式** 有利于程序的动态链接（因为它按逻辑段划分）。

分页管理方式中，**每个进程的页表都驻留在内存中**。

虚拟内存管理中，形成逻辑地址的阶段是 **链接**。

最容易产生碎片的动态分区分配算法是 **最佳适配**。

在多级分页系统中，PTR 存储的是 **顶级页表** 的起始地址。

### 虚拟内存管理

使用 $n$ 级页表并配置了 TLB 的系统中，设 TLB 命中率为 $r$、访存时间 $t_"mem"$、查询 TLB 时间 $t_"TLB"$，则：

- 先访问 TLB 一次，缺失时需查询 $n$ 级页表访存 $n$ 次，最后实际访存一次。
- 平均访存次数：$0 + (1 - r) times n + 1$
- 平均访问时间：$t_"TLB" + (1 - r) times n times t_"mem" + t_"mem"$。

系统有 $m$ 个物理块和 $n$ 个不同的页号，长期运行时，无论采用何种算法，缺页次数不会少于 $n$（每个页面首次访问必然缺页）。

虚拟存储器的容量 **只取决于逻辑地址位数**（与实际物理容量无关）。

> [!error] P229 T55

## 04 文件管理

### 文件系统基础

文件的逻辑结构是为了方便 **用户**（而非操作系统的管理）。

> [!error] P263 T19

### 目录

### 文件系统

## 05 I/O 管理

### I/O 管理概述

将系统中的每台设备按某种原则统一进行编号，这些编号作为区分硬件和识别设备的代号，该编号称为设备的 **绝对号**。

关于通道、设备控制器和设备之间的关系，以下叙述中正确的是 **通道控制设备控制器、设备控制器控制设备工作**。

系统配置了 2 台相同类型的绘图机和 3 台相同类型的打印机，则需要 **2** 个设备驱动程序（每类设备一个）。

在接收和处理一个输入设备的中断的过程中，一定不由硬件来完成的工作是 **主机获取设备输入**。

### 设备独立性软件

缓冲区管理着重要考虑的问题是 **实现进程访问缓冲区的同步**。

当设计针对传统机械式硬盘的磁盘调度算法时，主要考虑下列哪种因素对磁盘 I/O 的性能影响最为显著：**移动磁头的延迟**（寻道时间）。

相比常规硬盘，固态硬盘优势主要体现在 **随机** 存取的速度。

静态磨损均衡算法比动态磨损均衡算法的表现 **更优秀**。

不会导致磁头臂黏着的调度算法有 **FCFS**（SSTF / SCAN / C-SCAN 均可能）。